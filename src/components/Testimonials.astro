---
import TestimonialCard from "./ui/TestimonialCard.astro"
import { getReviews } from "../lib/wpapi"
import { record } from "astro:schema"

const reviews = await getReviews()
---

<section id="reviews" class="px-8 bg-white rounded-r-full lg:px-40 xl:px-50 md:px-14 py-30 pb-20 relative z-1 border-b-2 border-dashed border-gray-400/10">
  <h1 class="text-2xl sm:text-7xl text-center text- mb-10">Success Stories</h1>

  <div class="flex justify-center sm:*:max-w-6/8">
    <div class="swiper">
      <div class="swiper-wrapper">
        {
          reviews.length > 0 ? (
            reviews?.map(r => (
              <TestimonialCard
                author={r.author}
                authorPosition={r.authorPosition}
                authorCompany={r.authorCompany}
                message={r.message}
              />
            ))
          ) : (
            <div class="text-center py-20">
              We still don't have any success cases here
            </div>
          )
        }
      </div>
    </div>
  </div>
</section>

<script>
  import Swiper from 'swiper'
  import { Navigation, Pagination, Autoplay } from 'swiper/modules';
  import 'swiper/css';
  import 'swiper/css/navigation';
  import 'swiper/css/pagination';

  const swiper = new Swiper('.swiper', {
    modules: [Pagination, Autoplay],
    direction: 'horizontal',
    loop: true,
    autoplay: true,
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
      dynamicBullets: true
    },
    scrollbar: {
      el: '.swiper-scrollbar',
      draggable: true,
    },
  })
</script>